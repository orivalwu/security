### 用过什么安全设备
用过绿盟的全流量和WAF，以及开源的蜜罐HFish

### 应急响应的经验
在hw中，遇到过疑似主机被入侵的情况，然后通过``ps -ef``命令查看存在陌生的进程。通过webshell查杀工具，例如D盾找到了wehshell。接着通过日志查找攻击者的IP和攻击方式（playload等）。
最后检查一遍SSH密钥，计划任务，启动项等可能存在后门的地方，删除了木马和修改密码。

### WebShell管理工具的流量特征，Cobalt Strike的流量特征
- 菜刀：2014之前的版本中流量都是明文传输的，2016版本中对流量作了加密和混淆，但是还是有些关键函数没有加密的，比如``ini_set``, ``z0``, ``eval``, ``assert``等。菜刀的``$_GET``有可能被``$_POST``和``$_REQUEST``替代。

- 蚁剑的流量：对流量有加密，但是有些关键代码是没有加密的。比如PHP中的``ini_set``, ASP中的``OnError``,``response``等。具体来说，PHP中有``@ini_set('display_errors','0')``, 还有一个特征是存在``_0x...=``,以0x开头的参数名。

- 冰蝎: 动态二进制网站客户端，配合服务端的shell进行加密通信。流量特征：首先有一个强特征，那就是Content-Type字段一定是``application/octet-stream``。这表明我们的HTTP请求的数据是二进制数据，只能提交一个二进制流，如果是文件的话也只能提交一个文件，后台接受的参数只有一个。弱特征：3.0版本每次请求都会随机选择一个user-agnet头，如果用户不提供的话，则会从系统中随机选择一个。3.0中有16个头，useragent字段的值都比较老。

- 哥斯拉：哥斯拉客户端与shell建连初期的三个固定行为特征，且顺序出现在同一个TCP连接中。可以总结为：

  **特征：发送一段固定代码（payload），http响应为空**
  **特征：发送一段固定代码（test），执行结果为固定内容**
  **特征：发送一段固定代码（getBasicInfo）**

- CS的特征：
